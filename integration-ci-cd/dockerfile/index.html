



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.2, mkdocs-material-3.0.3">
    
    
      
        <title>Custom Docker Images - MoQuality Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700|">
        <style>body,input{font-family:"","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#custom-docker-images" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="MoQuality Docs" class="md-header-nav__button md-logo">
          
            <img src="/images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                MoQuality Docs
              </span>
              <span class="md-header-nav__topic">
                Custom Docker Images
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/moquality/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      MoQuality Docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Getting Started" class="md-tabs__link">
          Getting Started
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../recorder/" title="Barista" class="md-tabs__link">
          Barista
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../mq-cli/" title="Integrations" class="md-tabs__link md-tabs__link--active">
          Integrations
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../faq/" title="FAQ" class="md-tabs__link">
          FAQ
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="MoQuality Docs" class="md-nav__button md-logo">
      
        <img src="/images/logo.png" width="48" height="48">
      
    </a>
    MoQuality Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/moquality/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      MoQuality Docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="What is MoQuality?" class="md-nav__link">
      What is MoQuality?
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Barista
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Barista
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../recorder/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../recorder/android/" title="Android Setup" class="md-nav__link">
      Android Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../recorder/ios/" title="iOS Setup" class="md-nav__link">
      iOS Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../recorder/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../recorder/test-editing/" title="Test Editing" class="md-nav__link">
      Test Editing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Dashboard
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        Dashboard
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/view-results/" title="Test Reports" class="md-nav__link">
      Test Reports
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Workflows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        Workflows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../flows/documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1" checked>
    
    <label class="md-nav__link" for="nav-3-1">
      CI/CD
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        CI/CD
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../mq-cli/" title="MoQuality CLI" class="md-nav__link">
      MoQuality CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fastlane/" title="Integrate with fastlane" class="md-nav__link">
      Integrate with fastlane
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bitrise/" title="Integrate with Bitrise" class="md-nav__link">
      Integrate with Bitrise
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../circleci/" title="Integrate with CircleCI" class="md-nav__link">
      Integrate with CircleCI
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Custom Docker Images
      </label>
    
    <a href="./" title="Custom Docker Images" class="md-nav__link md-nav__link--active">
      Custom Docker Images
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-custom-docker-image" title="Create a Custom Docker Image" class="md-nav__link">
    Create a Custom Docker Image
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-empty-directory" title="Create Empty Directory" class="md-nav__link">
    Create Empty Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-dockerfile" title="Create Dockerfile" class="md-nav__link">
    Create Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-dockerfile" title="Open Dockerfile" class="md-nav__link">
    Open Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fill-dockerfile" title="Fill Dockerfile" class="md-nav__link">
    Fill Dockerfile
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#format" title="Format" class="md-nav__link">
    Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-image" title="Build Image" class="md-nav__link">
    Build Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confirm-image-existence" title="Confirm Image Existence" class="md-nav__link">
    Confirm Image Existence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-in-to-docker" title="Log in to Docker" class="md-nav__link">
    Log in to Docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-image" title="Tag Image" class="md-nav__link">
    Tag Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publish-image" title="Publish Image" class="md-nav__link">
    Publish Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circleci-and-custom-docker-images" title="CircleCI and Custom Docker Images" class="md-nav__link">
    CircleCI and Custom Docker Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-docker-image-to-job" title="Add Docker Image to Job" class="md-nav__link">
    Add Docker Image to Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circleci-image-as-base-image" title="CircleCI Image as Base Image" class="md-nav__link">
    CircleCI Image as Base Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circleci-and-custom-docker-image-for-moquality-app" title="CircleCI and Custom Docker Image for MoQuality App" class="md-nav__link">
    CircleCI and Custom Docker Image for MoQuality App
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#moqualitys-example-dockerfile" title="MoQuality's Example Dockerfile" class="md-nav__link">
    MoQuality's Example Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-empty-directory-for-git-repo" title="Create Empty Directory for Git Repo" class="md-nav__link">
    Create Empty Directory for Git Repo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clone-moquality-repository" title="Clone MoQuality Repository" class="md-nav__link">
    Clone MoQuality Repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configyml-contents" title="config.yml Contents" class="md-nav__link">
    config.yml Contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-configyml" title="Edit config.yml" class="md-nav__link">
    Edit config.yml
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troublshooting" title="Troublshooting" class="md-nav__link">
    Troublshooting
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#undocumented-error" title="Undocumented Error" class="md-nav__link">
    Undocumented Error
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Notifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Notifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-1" type="checkbox" id="nav-3-2-1">
    
    <label class="md-nav__link" for="nav-3-2-1">
      Slackbot
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-1">
        Slackbot
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notifications/slackbot/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notifications/slackbot/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-2" type="checkbox" id="nav-3-2-2">
    
    <label class="md-nav__link" for="nav-3-2-2">
      Gitbot
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-2">
        Gitbot
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notifications/gitbot/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notifications/gitbot/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      FAQ
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        FAQ
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-custom-docker-image" title="Create a Custom Docker Image" class="md-nav__link">
    Create a Custom Docker Image
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-empty-directory" title="Create Empty Directory" class="md-nav__link">
    Create Empty Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-dockerfile" title="Create Dockerfile" class="md-nav__link">
    Create Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-dockerfile" title="Open Dockerfile" class="md-nav__link">
    Open Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fill-dockerfile" title="Fill Dockerfile" class="md-nav__link">
    Fill Dockerfile
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#format" title="Format" class="md-nav__link">
    Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-image" title="Build Image" class="md-nav__link">
    Build Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confirm-image-existence" title="Confirm Image Existence" class="md-nav__link">
    Confirm Image Existence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-in-to-docker" title="Log in to Docker" class="md-nav__link">
    Log in to Docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-image" title="Tag Image" class="md-nav__link">
    Tag Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publish-image" title="Publish Image" class="md-nav__link">
    Publish Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circleci-and-custom-docker-images" title="CircleCI and Custom Docker Images" class="md-nav__link">
    CircleCI and Custom Docker Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-docker-image-to-job" title="Add Docker Image to Job" class="md-nav__link">
    Add Docker Image to Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circleci-image-as-base-image" title="CircleCI Image as Base Image" class="md-nav__link">
    CircleCI Image as Base Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circleci-and-custom-docker-image-for-moquality-app" title="CircleCI and Custom Docker Image for MoQuality App" class="md-nav__link">
    CircleCI and Custom Docker Image for MoQuality App
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#moqualitys-example-dockerfile" title="MoQuality's Example Dockerfile" class="md-nav__link">
    MoQuality's Example Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-empty-directory-for-git-repo" title="Create Empty Directory for Git Repo" class="md-nav__link">
    Create Empty Directory for Git Repo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clone-moquality-repository" title="Clone MoQuality Repository" class="md-nav__link">
    Clone MoQuality Repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configyml-contents" title="config.yml Contents" class="md-nav__link">
    config.yml Contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-configyml" title="Edit config.yml" class="md-nav__link">
    Edit config.yml
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troublshooting" title="Troublshooting" class="md-nav__link">
    Troublshooting
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#undocumented-error" title="Undocumented Error" class="md-nav__link">
    Undocumented Error
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/moquality/docs/tree/master/docs/docs/integration-ci-cd/dockerfile.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="custom-docker-images">Custom Docker Images<a class="headerlink" href="#custom-docker-images" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>A source of difficulty when developing applications is creating the perfect environment on one's machine to run said application. However, by using Docker, you can set up the perfect environment to run your application. Dockerfiles define the environment within a container, a runtime instance of an image. An image is an executable package that cointains an application's code, runtime, libraries, environment variables, and configuration files. A Dockerfile can use an image, such as Ubuntu, and define the environment on top of the image. Thus, we can run an app in, for example, an Ubuntu container with all the necessary dependencies installed, as defined in our Dockerfile. These instructions follow the creation of a Dockerfile for testing a calculator app, available [here], and are based off of <a href="https://docs.docker.com/get-started/part2/#introduction">this</a> Docker documentation.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Docker: Install your preferred version of Docker <a href="https://docs.docker.com/install/">here</a> and use the <a href="https://docs.docker.com/get-started/">official Docker getting started guide</a> to familiarize yourself with Docker.</li>
<li>Docker account: Set up a Docker account <a href="https://cloud.docker.com/">here</a>.</li>
</ul>
<h2 id="create-a-custom-docker-image">Create a Custom Docker Image<a class="headerlink" href="#create-a-custom-docker-image" title="Permanent link">&para;</a></h2>
<h3 id="create-empty-directory">Create Empty Directory<a class="headerlink" href="#create-empty-directory" title="Permanent link">&para;</a></h3>
<p>Create an empty directory and navigate into that directory within your command line.</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> <span class="o">[</span>EMPTY_DIRECTORY<span class="o">]</span>
</pre></div>


<h3 id="create-dockerfile">Create <code>Dockerfile</code><a class="headerlink" href="#create-dockerfile" title="Permanent link">&para;</a></h3>
<p>Within that directory, create a file called <code>Dockerfile</code>. This is where you will define the environment of your container.</p>
<h3 id="open-dockerfile">Open <code>Dockerfile</code><a class="headerlink" href="#open-dockerfile" title="Permanent link">&para;</a></h3>
<p>Open <code>Dockerfile</code> in an editor of your choice.</p>
<h3 id="fill-dockerfile">Fill <code>Dockerfile</code><a class="headerlink" href="#fill-dockerfile" title="Permanent link">&para;</a></h3>
<p>Fill the Dockerfile while following the format below. A very short example Dockerfile is beneath the format. The <a href="https://docs.docker.com/engine/reference/builder/#from">FROM instruction</a> initializes a new build stage and sets the base image. The <a href="https://docs.docker.com/engine/reference/builder/#run">RUN instruction</a> runs a command within our docker container. For more reference on instructions and information on Docker syntax, click <a href="https://docs.docker.com/engine/reference/builder/#usage">here</a>.</p>
<h4 id="format">Format<a class="headerlink" href="#format" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="c"># Comment</span>
INSTRUCTION arguments
</pre></div>


<h4 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="c">#Use an official Ubuntu runtime as a parent image</span>
<span class="k">FROM</span><span class="s"> ubuntu</span>

<span class="c">#Say hello</span>
<span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&quot;Hello world!&quot;</span>
</pre></div>


<h3 id="build-image">Build Image<a class="headerlink" href="#build-image" title="Permanent link">&para;</a></h3>
<p>Now that you have a Dockerfile with instructions, it's time to build your image. Run the below command, inserting your own tag for the image. <strong>Note the period after the image tag</strong>.</p>
<div class="codehilite"><pre><span></span>docker build -t <span class="o">[</span>LOCAL_IMAGE_TAG<span class="o">]</span> .
</pre></div>


<h3 id="confirm-image-existence">Confirm Image Existence<a class="headerlink" href="#confirm-image-existence" title="Permanent link">&para;</a></h3>
<p>Once your image is done building, you can confirm that it is in your machine’s local Docker image registry with the below command.</p>
<div class="codehilite"><pre><span></span>docker image ls
</pre></div>


<h3 id="log-in-to-docker">Log in to Docker<a class="headerlink" href="#log-in-to-docker" title="Permanent link">&para;</a></h3>
<p>To share your image, log in to docker with the below command.</p>
<div class="codehilite"><pre><span></span>docker login
</pre></div>


<h3 id="tag-image">Tag Image<a class="headerlink" href="#tag-image" title="Permanent link">&para;</a></h3>
<p>Before uploading your image, you should give it a tag for Docker Hub using the following command. An example of a repository name and tag could be <code>dockertesting:latest</code>. If no tag is given, Docker will tag the image with <code>latest</code> by default.</p>
<div class="codehilite"><pre><span></span>docker tag <span class="o">[</span>LOCAL_IMAGE_TAG<span class="o">]</span> <span class="o">[</span>DOCKER_USERNAME<span class="o">]</span>/<span class="o">[</span>REPOSITORY_NAME<span class="o">]</span>:<span class="o">[</span>TAG<span class="o">]</span>
</pre></div>


<h3 id="publish-image">Publish Image<a class="headerlink" href="#publish-image" title="Permanent link">&para;</a></h3>
<p>Publish the image with below command.</p>
<div class="codehilite"><pre><span></span>docker push <span class="o">[</span>DOCKER_USERNAME<span class="o">]</span>/<span class="o">[</span>REPOSITORY_NAME<span class="o">]</span>:<span class="o">[</span>TAG<span class="o">]</span>
</pre></div>


<p>Now your image is accessible from online and can be pulled at any time. The next set of instructions explain how you can use your Docker image in CircleCI.</p>
<h2 id="circleci-and-custom-docker-images">CircleCI and Custom Docker Images<a class="headerlink" href="#circleci-and-custom-docker-images" title="Permanent link">&para;</a></h2>
<p>CircleCI supports the use of custom Docker images, and the CircleCI documentation on customizing Docker images for CircleCI can be found <a href="https://circleci.com/docs/2.0/custom-images/">here</a>.</p>
<h3 id="add-docker-image-to-job">Add Docker Image to Job<a class="headerlink" href="#add-docker-image-to-job" title="Permanent link">&para;</a></h3>
<p>If you have built and pushed a custom Docker image, you can use it in your CircleCI job by adding the image path to the Docker executor in your job.</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">job</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">build</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">docker</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">DOCKER_USERNAME</span><span class="p p-Indicator">]</span><span class="l l-Scalar l-Scalar-Plain">/[REPOSITORY_NAME]:[TAG]</span>
</pre></div>


<p>The information in brackets can be found by visiting your image on <a href="https://hub.docker.com/">Docker Hub</a> and selecting your repository. The Docker pull command will be on the repository page, and you can find your tag under the Tags tab.</p>
<h3 id="circleci-image-as-base-image">CircleCI Image as Base Image<a class="headerlink" href="#circleci-image-as-base-image" title="Permanent link">&para;</a></h3>
<p>You can also build your custom Docker image on top of a CirlceCI image. Say you want to use the <code>circleci/android:api-25-alpha</code> image, but you need to add more dependencies. You can create a Dockerfile and begin it with the following.</p>
<div class="codehilite"><pre><span></span><span class="k">FROM</span><span class="s"> circleci/android:api-25-alpha</span>
</pre></div>


<p>Now you can add your instructions to set up an environment within a CircleCI container. The next section breaks down an exmaple Docker image used with CircleCI to build and upload an app to MoQuality.</p>
<h2 id="circleci-and-custom-docker-image-for-moquality-app">CircleCI and Custom Docker Image for MoQuality App<a class="headerlink" href="#circleci-and-custom-docker-image-for-moquality-app" title="Permanent link">&para;</a></h2>
<p>MoQuality has created a <a href="https://github.com/moquality/devcenter">Github repository</a> with all the necessary files to build and upload a calculator app to MoQuality by using CircleCI and a custom Dockerfile. Our Dockerfile uses Ubuntu as our parent image and installs dependencies such as Gradle to build the app. The Docker image path is <code>jragonemq/mqubuntutest:latest</code>. Before beginning, create an app on MoQuality that you can use to test the upload properties of this build. It does not matter what apk file you upload upon creation of the app.</p>
<h3 id="moqualitys-example-dockerfile">MoQuality's Example <code>Dockerfile</code><a class="headerlink" href="#moqualitys-example-dockerfile" title="Permanent link">&para;</a></h3>
<p>The following is the code behind the <code>jragonemq/mqubuntutest:latest</code> Dockerfile. This creates an environment for running the calculator app on top of an Ubuntu parent image. We are essentially filling a fresh Ubuntu container with our dependencies. The comments explain what each set of instructions is doing. However, understanding each instruction is less important than understanding what these instructions accomplish holistically: they build the environment.</p>
<div class="codehilite"><pre><span></span><span class="c">#Use an official Ubuntu runtime as a parent image</span>
<span class="k">FROM</span><span class="s"> ubuntu</span>

<span class="c">#Set user to root</span>
USER root

<span class="c">#Update apt-get and install dependencies</span>
<span class="k">RUN</span> apt-get -y update <span class="o">&amp;&amp;</span> apt-get install -y wget bzip2 unzip gcc nodejs npm openjdk-8-jdk git sudo curl

<span class="c">#Install Gradle</span>
<span class="k">RUN</span> wget https://services.gradle.org/distributions/gradle-4.1-bin.zip
<span class="k">RUN</span> mkdir /opt/gradle
<span class="k">RUN</span> unzip -d /opt/gradle gradle-4.1-bin.zip
<span class="c">#Define environment variable</span>
<span class="k">ENV</span><span class="s"> PATH=$PATH:/opt/gradle/gradle-4.1/bin</span>
<span class="k">RUN</span> gradle -v

<span class="c">#Install Android tools for sdkmanager</span>
<span class="k">RUN</span> mkdir /android-sdk
<span class="k">RUN</span> wget https://dl.google.com/android/repository/sdk-tools-darwin-3859397.zip
<span class="k">RUN</span> unzip -d /android-sdk sdk-tools*.zip
<span class="k">ENV</span><span class="s"> ANDROID_HOME=/android-sdk</span>
<span class="k">ENV</span><span class="s"> PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/tools/bin:$ANDROID_HOME/tools/platform-tools:$ANDROID_HOME/build-tools/26.0.2</span>

<span class="c">#Accept all licenses and install dependencies</span>
<span class="k">RUN</span> yes <span class="p">|</span> sdkmanager --licenses
<span class="k">RUN</span> sdkmanager <span class="s2">&quot;platforms;android-22&quot;</span>
<span class="k">RUN</span> sdkmanager <span class="s2">&quot;build-tools;26.0.2&quot;</span>

<span class="c">#Copy Android</span>
COPY android-8.0.0 android
<span class="k">ENV</span><span class="s"> PATH=&quot;/android:$PATH&quot;</span>
</pre></div>


<h3 id="create-empty-directory-for-git-repo">Create Empty Directory for Git Repo<a class="headerlink" href="#create-empty-directory-for-git-repo" title="Permanent link">&para;</a></h3>
<p>Create an empty directory and <code>cd</code> into it.</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> <span class="o">[</span>EMPTY_DIRECTORY<span class="o">]</span>
</pre></div>


<h3 id="clone-moquality-repository">Clone MoQuality Repository<a class="headerlink" href="#clone-moquality-repository" title="Permanent link">&para;</a></h3>
<p>Clone MoQuality's example repository using <code>git clone</code>.</p>
<div class="codehilite"><pre><span></span>git clone https://github.com/moquality/plugins.git
</pre></div>


<h3 id="configyml-contents"><code>config.yml</code> Contents<a class="headerlink" href="#configyml-contents" title="Permanent link">&para;</a></h3>
<p>Within the hidden <code>.circleci</code> folder is the <code>config.yml</code> file. In this file are steps which build the app using <code>gradle build</code>, <a href="../circleci/#instructions">install the mq-cli</a>, and <a href="../circleci/#instructions">login and upload the app to MoQuality</a>.</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">version</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="l l-Scalar l-Scalar-Plain">jobs</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">build</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">docker</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">jragonemq/mqubuntutest:latest</span>
    <span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">JVM_OPTS</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">-Xmx3200m</span>
    <span class="l l-Scalar l-Scalar-Plain">steps</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">checkout</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Build app</span>
          <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">gradle build</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Install mq-cli</span>
          <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
            <span class="no">curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -</span>
            <span class="no">sudo apt-get install -y nodejs</span>
            <span class="no">sudo chown -R $(whoami) /usr/lib/node_modules /usr/bin</span>
            <span class="no">npm -g config set user root</span>
            <span class="no">npm install -g mq-cli</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Login and Upload to MoQuality</span>
          <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
<span class="hll">            <span class="no">mq login -a [API_KEY]</span>
</span>            <span class="no">mq user</span>
<span class="hll">            <span class="no">mq upload -f app/build/outputs/apk/debug/app-debug.apk -a [APP_ID]</span>
</span>            <span class="no">mq apps</span>
</pre></div>


<h3 id="edit-configyml">Edit <code>config.yml</code><a class="headerlink" href="#edit-configyml" title="Permanent link">&para;</a></h3>
<p>By the <code>mq login</code> and <code>mq upload</code> commands, highlighted above, fill in [API_KEY] and [APP_ID] with the API key of your account and app Id of your app, respectively. To find your API key, run <code>mq login</code> in your command line and follow the prompts to log in to your account. Next, run <code>mq user</code> to display user information. Your API key will be in the list of returned information. To find your app Id, log in with <code>mq login</code> and run <code>mq apps</code> to see a list of your apps. Find your app in the list and locate the app Id in the same row.</p>
<p>Using the above instructions and <a href="../circleci/">CircleCI MQ CLI integration documentation</a>, we have created our own custom Dockerfile, integrated it with CircleCI, and integrated CircleCI with MoQuality.</p>
<h2 id="troublshooting">Troublshooting<a class="headerlink" href="#troublshooting" title="Permanent link">&para;</a></h2>
<h3 id="undocumented-error">Undocumented Error<a class="headerlink" href="#undocumented-error" title="Permanent link">&para;</a></h3>
<p>If you encounter an error that is not documented, please open an issue on our <a href="https://github.com/moquality/devcenter/issues">public GitHub repository</a>. Alternatively, you can report your error to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#104;&#101;&#108;&#108;&#111;&#64;&#109;&#111;&#113;&#117;&#97;&#108;&#105;&#116;&#121;&#46;&#99;&#111;&#109;">&#104;&#101;&#108;&#108;&#111;&#64;&#109;&#111;&#113;&#117;&#97;&#108;&#105;&#116;&#121;&#46;&#99;&#111;&#109;</a>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../circleci/" title="Integrate with CircleCI" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Integrate with CircleCI
              </span>
            </div>
          </a>
        
        
          <a href="../../notifications/slackbot/getting-started/" title="Getting Started" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Getting Started
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 MoQuality, Inc.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/moquality" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/moqualityinc" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.2",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>